module:
  schema: "public"
  table: "roll_call"
  identifier: "roll_call"
  label: "Roll Call Votes"
  description: "NYS legislative roll call votes with yea/nay/absent counts"

  dimensions:
    - column: "chamber"
      type: "categorical"
      label: "Chamber"
      description: "Legislative chamber (Senate or Assembly)"

    - column: "description"
      type: "categorical"
      label: "Description"
      description: "Vote description"

    - column: "date"
      type: "categorical"
      label: "Vote Date"
      description: "Date of the roll call vote"

  joinPaths:
    - from:
        column: "bill_id"
      to:
        schema: "public"
        table: "bills"
        column: "bill_id"
      type: "one-to-one"

  metrics:
    - identifier: "total_roll_calls"
      name: "Total Roll Calls"
      description: "Total number of roll call votes"
      calculation: "custom-value"
      sql_expression: "COUNT(*)"
      time: "roll_call.created_at"
      dimensions:
        - "this.*"
        - "public.bills.*"

    - identifier: "total_yea_votes"
      name: "Total Yea Votes"
      description: "Sum of all yea votes across roll calls"
      calculation: "custom-value"
      sql_expression: "SUM(yea)"
      time: "roll_call.created_at"
      dimensions:
        - "this.*"
        - "public.bills.*"

    - identifier: "avg_yea_votes"
      name: "Avg Yea Votes Per Roll Call"
      description: "Average yea votes per roll call"
      calculation: "custom-value"
      sql_expression: "AVG(yea)"
      time: "roll_call.created_at"
      dimensions:
        - "this.*"
        - "public.bills.*"

    - identifier: "avg_total_votes"
      name: "Avg Total Votes"
      description: "Average total votes per roll call"
      calculation: "custom-value"
      sql_expression: "AVG(total)"
      time: "roll_call.created_at"
      dimensions:
        - "this.*"
        - "public.bills.*"
